# MongoDB Aggregation Pipeline Error: Mismatched Fields in $lookup after $group
This repository demonstrates a common error in MongoDB aggregation pipelines: mismatched fields between the $group and $lookup stages.
The `bug.js` file contains code that produces incorrect results. The `bugSolution.js` file provides a corrected version.

## Bug Description
The original aggregation pipeline attempts to perform a `$lookup` after a `$group` stage.  However, the `_id` field generated by the `$group` stage does not directly match the `_id` field in the `users` collection. This mismatch leads to an empty `user` array in the result set.

## Solution
The solution involves restructuring the pipeline to correctly handle the different fields.  The corrected pipeline uses an `$unwind` stage before `$lookup` to correctly join the documents.